(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-437d"],{"+wyk":function(t,e,i){"use strict";i.r(e);var o=i("unDg"),a=i.n(o),s=i("6ZY3"),n=i.n(s),l=i("Mz3J"),r=i("GquX"),c=i("dsdk"),u=i("ISyM"),d=i("xA6U"),m=(i("RYct"),{name:"product_service",components:{Pagination:l.a,synchrodataDialog:r.a,actionBar:c.a,uploadImage:u.a},data:function(){var t=function(t,e,i){if(e||0==e){/^(\-|\+)?\d+(\.\d+)?$/.test(e)?i():i(new Error)}else i(new Error)};return{commandFilterList:[],multipleSelection:[],listLoading:!0,goodsList:[],temp:{id:null,hour:0,minute:0,item:{name:"",category_id:null,price:void 0,remark:"",code:"",service_time:"",imageurl:""}},rules:{"item.code":[{required:!0,trigger:"blur",message:"编码不能为空"},{validator:function(t,e,i){(e||0==e)&&/^[0-9]*$/.test(e)?i():i(new Error)},trigger:"blur",message:"编码格式不正确"}],"item.name":[{required:!0,trigger:"blur",message:"名称不能为空"}],"item.category_id":[{required:!0,trigger:"change",message:"分类不能为空"}],"item.price":[{required:!0,trigger:"blur",message:"单价不能为空"},{validator:t,trigger:"blur",message:"单价格式不正确"}],hour:[{required:!0,trigger:"blur",message:"时不能为空"},{validator:t,trigger:"blur",message:"时格式不正确"}],minute:[{required:!0,trigger:"blur",message:"分不能为空"},{validator:t,trigger:"blur",message:"分格式不正确"}]},dialogEditFormVisible:!1,synchrodataDialog:{show:!1,activeName:1},dialogStatus:"",dialogTitle:{create:"新增服务",edit:"编辑服务"},editStatus:{autoAdd:!1,autoCoding:!1},listQuery:{page:1,limit:20,category_id:"",search:"",price:"",code:""},total:0,layout:" sizes, jumper, next, pager, prev, total",activeTab:"0",stopGoodsList:[],stopListLoading:!0,stopListQuery:{page:1,limit:10,type:1},stopTotal:0,multipleSelectionStop:[]}},methods:{handleCommand:function(t){"del"==t?this.showDelBox():"stop"==t?this.showStopBox():this.showSaleBox()},handleGoodsFilter:function(){this.listQuery.page=1,this.getGoodsList()},handleSearch:function(){this.handleGoodsFilter()},handleSelectionChange:function(t){0==this.activeTab?this.multipleSelection=t:this.multipleSelectionStop=t},showDelBox:function(){var t=this;0!=this.multipleSelectionStop.length?this.$confirm("确定永久性删除此商品吗?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){t.handledelGoods()}).catch(function(t){}):this.$message.warning("请选择商品进行操作")},handledelGoods:function(){var t=[];this.multipleSelectionStop.forEach(function(e,i){t.push(e.product_id)});var e=t.join(",");this.deleteProducts(e)},handleSort:function(t){var e={},i=t.prop,o="ascending"==t.order?"asc":"descending"==t.order?"desc":"";switch(console.log(t),i){case"code":e.code=o;break;case"category":e.category=o;break;case"price":e.price=o;break;case"service_time":e.service_time=o;break;case null:e={}}var a=this.listQuery,s=a.limit,l=a.category_id,r=a.search;this.listQuery=n()({},{page:1,limit:s,category_id:l,search:r},e),this.getGoodsList(),console.log(this.listQuery)},resetTemp:function(){this.temp={id:null,hour:0,minute:0,item:{name:"",category_id:this.commandFilterList[0].id,price:void 0,remark:"",code:"",service_time:"",imageurl:""}}},handleAdd:function(){var t=this;this.resetTemp(),Object(d.p)().then(function(e){var i=e.success.data;t.temp.item.code=i.code,console.log(i.code),console.log(t.temp.code),t.editStatus.autoCoding=""!=t.temp.item.code,t.dialogStatus="create",t.dialogEditFormVisible=!0,t.$nextTick(function(){t.$refs.dataForm.clearValidate()})})},createData:function(){var t=this;this.$refs.dataForm.validate(function(e){e&&(t.temp.item.service_time=t.temp.hour+","+t.temp.minute,Object(d.e)(t.temp.item).then(function(e){console.log(t.temp),t.getGoodsList(),t.$message.success("新增成功"),t.editStatus.autoAdd?t.handleAdd():(t.dialogEditFormVisible=!1,console.log(t.temp.item))}).catch(function(t){console.log(t)}))})},handleEdit:function(t){var e=this;this.resetTemp(),this.editStatus.autoCoding=!0,this.temp.id=t.id,console.log(this.temp.id),Object(d.s)(this.temp.id).then(function(t){var i=t.success.data;console.log(i);var o=i.code,a=i.service_time,s=i.item,l=s.category_id,r=s.imageurl,c=s.name,u=s.price,d=s.remark,m=a.split(",");console.log(m),e.temp.hour=m[0],e.temp.minute=m[1],e.temp=n()({},e.temp,{item:{category_id:l,name:c,price:u,remark:d,code:o,service_time:a,imageurl:r}}),e.dialogStatus="edit",e.dialogEditFormVisible=!0,e.$nextTick(function(){e.$refs.dataForm.clearValidate()})})},updateData:function(){var t=this;this.$refs.dataForm.validate(function(e){e&&(t.temp.item.service_time=t.temp.hour+","+t.temp.minute,Object(d.m)(t.temp.id,t.temp.item).then(function(e){t.dialogEditFormVisible=!1,console.log(t.temp),t.getGoodsList(),t.$message.success("编辑成功")}).catch(function(t){console.log(t)}))})},getGoodsList:function(){var t=this;Object(d.y)(this.listQuery).then(function(e){var i=e.success.data;0==t.commandFilterList.length&&(t.commandFilterList=[].concat(a()(i.cateinfo))),t.goodsList=[].concat(a()(i.item.data)),t.total=i.item.total,t.listLoading=!1})},handleDelete:function(t){var e=this,i=t.product_id;this.$confirm("确定永久性删除此商品吗?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){e.deleteProducts(i)}).catch(function(t){})},deleteProducts:function(t){var e=this;Object(d.i)(t).then(function(t){e.getStopGoodsList(),e.$message.success("删除成功")}).catch(function(t){console.log(t),e.$message.error("删除失败")})},getStopGoodsList:function(){var t=this;this.stopListLoading=!0,Object(d.w)(this.stopListQuery).then(function(e){var i=e.success.data;t.stopGoodsList=[].concat(a()(i.data)),t.stopTotal=i.total,t.stopListLoading=!1,console.log("停售产品列表",t.stopGoodsList)}).catch(function(t){})},handleStop:function(t){var e=this,i=t.item_id;this.$confirm("确定停售此商品吗?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){e.stopProducts(i)}).catch(function(t){})},stopProducts:function(t){var e=this;Object(d.z)(t).then(function(t){e.getGoodsList(),e.getStopGoodsList(),e.$message.success("停售成功")}).catch(function(t){console.log(t)})},handleSale:function(t){var e=this,i=t.id;this.$confirm("确定开售此商品吗?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){e.saleProducts(i)}).catch(function(t){})},saleProducts:function(t){var e=this;Object(d.x)(t).then(function(t){e.getGoodsList(),e.getStopGoodsList(),console.log("开售成功")}).catch(function(t){console.log(t)})},showStopBox:function(){var t=this;0!=this.multipleSelection.length?this.$confirm("确定停售此商品吗?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){var e=t.multipleSelection.map(function(t,e){return t.item_id});e.join(","),t.stopProducts(e)}).catch(function(t){}):this.$message.warning("请选择商品进行操作")},showSaleBox:function(){var t=this;0!=this.multipleSelectionStop.length?this.$confirm("确定开售此商品吗?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){var e=t.multipleSelectionStop.map(function(t,e){return t.id});e.join(","),t.saleProducts(e)}).catch(function(t){}):this.$message.warning("请选择商品进行操作")}},mounted:function(){},created:function(){this.getGoodsList()},computed:{syncDialogShow:function(){return this.synchrodataDialog.show}},watch:{syncDialogShow:function(t,e){t||this.getGoodsList()},activeTab:function(t,e){0!=t||this.goodsList.length?1!=t||this.stopGoodsList.length||this.getStopGoodsList():this.getGoodsList()}}}),p=(i("xjAN"),i("oo2p"),i("ZrdR")),g=Object(p.a)(m,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container product_service"},[i("el-card",{staticClass:"filter-box mb-15",attrs:{shadow:"always"}},[i("action-bar",{attrs:{activeName:t.synchrodataDialog.activeName,category_id:t.listQuery.category_id,commandFilterList:t.commandFilterList,search:t.listQuery.search,activeTab:t.activeTab},on:{"update:category_id":function(e){t.$set(t.listQuery,"category_id",e)},"update:search":function(e){t.$set(t.listQuery,"search",e)},"update:activeTab":function(e){t.activeTab=e},handleCommand:t.handleCommand,handleGoodsFilter:t.handleGoodsFilter,handleSearch:t.handleSearch,showSynchroDialog:function(e){t.synchrodataDialog.show=!0},handleAdd:t.handleAdd}},[i("template",{slot:"0"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"goodsList",staticClass:"goods_list",staticStyle:{width:"100%"},attrs:{data:t.goodsList,fit:"",stripe:""},on:{"selection-change":t.handleSelectionChange,"sort-change":t.handleSort}},[i("el-table-column",{attrs:{align:"left",type:"index",width:"40px"}}),t._v(" "),i("el-table-column",{attrs:{align:"left",type:"selection",width:"30px"}}),t._v(" "),i("el-table-column",{attrs:{align:"left",label:"编码",prop:"code",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.code))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"left",label:"名称",prop:"name",width:"420px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"product_name"},[i("span",{staticClass:"product_img"},[i("img",{directives:[{name:"productImg",rawName:"v-productImg",value:e.row.item.imageurl,expression:"scope.row.item.imageurl"}]})]),t._v("\n                "+t._s(e.row.item.name)+"\n              ")])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"left",label:"来源"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.item.source_item_id>0?"总部分配":"单店添加"))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"left",label:"分类",prop:"category",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.item.category?e.row.item.category.name:"-"))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"left",label:"单价",prop:"price",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t._f("formatMoney")(e.row.item.price)))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"left",label:"服务时长",prop:"service_time",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.service_time))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"left",label:"备注",prop:"remark"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(null==e.row.item.remark||""==e.row.item.remark?"-":e.row.item.remark))])]}}])}),t._v(" "),i("el-table-column",{attrs:{width:"160",align:"left",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){t.handleEdit(e.row)}}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:function(i){t.handleStop(e.row)}}},[t._v("停售")])]}}])})],1),t._v(" "),i("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],staticClass:"pagination",attrs:{layout:t.layout,total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){t.$set(t.listQuery,"page",e)},"update:limit":function(e){t.$set(t.listQuery,"limit",e)},pagination:t.getGoodsList}})],1),t._v(" "),i("template",{slot:"1"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.stopListLoading,expression:"stopListLoading"}],ref:"goodsList",staticClass:"goods_list",staticStyle:{width:"100%"},attrs:{data:t.stopGoodsList,fit:"",stripe:""},on:{"selection-change":t.handleSelectionChange,"sort-change":t.handleSort}},[i("el-table-column",{attrs:{align:"left",type:"index",width:"40px"}}),t._v(" "),i("el-table-column",{attrs:{align:"left",type:"selection",width:"30px"}}),t._v(" "),i("el-table-column",{attrs:{align:"left",label:"编码",prop:"code",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.code))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"left",label:"名称",prop:"name",width:"420px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"product_name"},[i("span",{staticClass:"product_img"},[i("img",{directives:[{name:"productImg",rawName:"v-productImg",value:e.row.imageurl,expression:"scope.row.imageurl"}]})]),t._v("\n                "+t._s(e.row.name)+"\n              ")])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"left",label:"来源"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.source_item_id>0?"总部分配":"单店添加"))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"left",label:"分类",prop:"category",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.category?e.row.category.name:"-"))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"left",label:"单价",prop:"price",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t._f("formatMoney")(e.row.price)))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"left",label:"服务时长",prop:"service_time",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.service_time))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"left",label:"备注",prop:"remark"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(null==e.row.remark||""==e.row.remark?"-":e.row.remark))])]}}])}),t._v(" "),i("el-table-column",{attrs:{width:"160",align:"left",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){t.handleSale(e.row)}}},[t._v("开售")]),t._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:function(i){t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),i("pagination",{directives:[{name:"show",rawName:"v-show",value:t.stopTotal>0,expression:"stopTotal>0"}],staticClass:"pagination",attrs:{layout:t.layout,total:t.stopTotal,page:t.stopListQuery.page,limit:t.stopListQuery.limit},on:{"update:page":function(e){t.$set(t.stopListQuery,"page",e)},"update:limit":function(e){t.$set(t.stopListQuery,"limit",e)},pagination:t.getStopGoodsList}})],1)],2),t._v(" "),i("el-dialog",{staticClass:"goods_dialog",attrs:{title:t.dialogTitle[t.dialogStatus],visible:t.dialogEditFormVisible,width:"770px"},on:{"update:visible":function(e){t.dialogEditFormVisible=e},closed:function(e){t.editStatus.autoAdd=!1}}},[i("el-form",{ref:"dataForm",attrs:{"label-position":"right","label-width":"80px",model:t.temp,rules:t.rules,"show-message":!0}},[i("el-row",{attrs:{gutter:20}},[i("el-col",{staticClass:"left_content",attrs:{span:13}},[i("upload-image",{attrs:{imageurl:t.temp.item.imageurl},on:{"update:imageurl":function(e){t.$set(t.temp.item,"imageurl",e)}}})],1),t._v(" "),i("el-col",{staticClass:"right_content",attrs:{span:11}},[i("el-form-item",{attrs:{label:"编码",prop:"item.code"}},[i("el-input",{model:{value:t.temp.item.code,callback:function(e){t.$set(t.temp.item,"code",e)},expression:"temp.item.code"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"服务名称",prop:"item.name"}},[i("el-input",{model:{value:t.temp.item.name,callback:function(e){t.$set(t.temp.item,"name",e)},expression:"temp.item.name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"服务分类",prop:"item.category_id"}},[i("el-select",{staticStyle:{width:"100%"},model:{value:t.temp.item.category_id,callback:function(e){t.$set(t.temp.item,"category_id",e)},expression:"temp.item.category_id"}},t._l(t.commandFilterList,function(t,e,o){return i("el-option",{key:o,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"单价",prop:"item.price"}},[i("el-input",{model:{value:t.temp.item.price,callback:function(e){t.$set(t.temp.item,"price","string"==typeof e?e.trim():e)},expression:"temp.item.price"}})],1),t._v(" "),i("el-form-item",{staticClass:"service_time",attrs:{label:"服务时长",required:""}},[i("el-row",[i("el-col",{staticClass:"time_input",attrs:{span:10}},[i("el-form-item",{attrs:{prop:"hour"}},[i("el-input",{staticClass:"time_input",on:{change:function(e){t.temp.hour=t.temp.hour?t.temp.hour:0}},model:{value:t.temp.hour,callback:function(e){t.$set(t.temp,"hour","string"==typeof e?e.trim():e)},expression:"temp.hour"}})],1)],1),t._v(" "),i("el-col",{staticClass:"line tip",attrs:{span:2}},[i("span",[t._v("时")])]),t._v(" "),i("el-col",{staticClass:"time_input",attrs:{span:10}},[i("el-form-item",{attrs:{prop:"minute"}},[i("el-input",{staticClass:"time_input",on:{change:function(e){t.temp.minute=t.temp.minute?t.temp.minute:0}},model:{value:t.temp.minute,callback:function(e){t.$set(t.temp,"minute","string"==typeof e?e.trim():e)},expression:"temp.minute"}})],1)],1),t._v(" "),i("el-col",{staticClass:"line tip",attrs:{span:2}},[i("span",[t._v("分")])])],1)],1),t._v(" "),i("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{label:"备注"}},[i("el-input",{attrs:{type:"textarea",rows:3},model:{value:t.temp.item.remark,callback:function(e){t.$set(t.temp.item,"remark",e)},expression:"temp.item.remark"}})],1)],1)],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",staticStyle:{"vertical-align":"middle"},attrs:{slot:"footer"},slot:"footer"},["create"==t.dialogStatus?i("div",{staticClass:"fl",staticStyle:{"vertical-align":"middle","margin-top":"10px"}},[i("el-checkbox",{model:{value:t.editStatus.autoAdd,callback:function(e){t.$set(t.editStatus,"autoAdd",e)},expression:"editStatus.autoAdd"}},[t._v("连续增加")])],1):t._e(),t._v(" "),i("el-button",{on:{click:function(e){t.dialogEditFormVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){"create"==t.dialogStatus?t.createData():t.updateData()}}},[t._v("确 定")])],1)],1),t._v(" "),i("synchrodata-dialog",{attrs:{visible:t.synchrodataDialog.show,activeName:t.synchrodataDialog.activeName},on:{"update:visible":function(e){t.$set(t.synchrodataDialog,"show",e)}}})],1)],1)},[],!1,null,"2bc29ad2",null);g.options.__file="service.vue";e.default=g.exports},aupB:function(t,e,i){},oo2p:function(t,e,i){"use strict";var o=i("aupB");i.n(o).a},"w/bM":function(t,e,i){},xjAN:function(t,e,i){"use strict";var o=i("w/bM");i.n(o).a}}]);