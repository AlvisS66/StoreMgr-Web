(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5ccb"],{"+Ao4":function(t,e,o){"use strict";var i=o("mhk/");o.n(i).a},ZWgD:function(t,e,o){"use strict";var i=o("omHS");o.n(i).a},"mhk/":function(t,e,o){},omHS:function(t,e,o){},tdol:function(t,e,o){"use strict";o.r(e);var i=o("unDg"),a=o.n(i),n=o("6ZY3"),s=o.n(n),l=o("Mz3J"),r=o("GquX"),c=o("dsdk"),u=o("ISyM"),d=o("xA6U"),m={name:"product_goods",components:{Pagination:l.a,synchrodataDialog:r.a,actionBar:c.a,uploadImage:u.a},data:function(){return{commandFilterList:[],multipleSelection:[],listLoading:!0,goodsList:[],temp:{id:null,item:{name:"",category_id:null,price:"",remark:"",code:"",sku:"",imageurl:""}},rules:{"item.code":[{required:!0,trigger:"blur",message:"编码不能为空"},{validator:function(t,e,o){""==e||void 0==e?o(new Error):/^[0-9]*$/.test(e)?o():o(new Error)},trigger:"blur",message:"编码格式不正确"}],"item.name":[{required:!0,trigger:"blur",message:"名称不能为空"}],"item.category_id":[{required:!0,trigger:"change",message:"分类不能为空"}],"item.price":[{required:!0,trigger:"blur",message:"单价不能为空"},{validator:function(t,e,o){""==e||void 0==e?o(new Error):/^(\-|\+)?\d+(\.\d+)?$/.test(e)?o():o(new Error)},trigger:"blur",message:"单价格式不正确"}]},dialogEditFormVisible:!1,synchrodataDialog:{show:!1,activeName:0},dialogStatus:"",dialogTitle:{create:"新增商品",edit:"编辑商品"},editStatus:{autoAdd:!1,autoCoding:!1},listQuery:{page:1,limit:10,category_id:"",search:"",price:"",code:""},total:0,layout:" sizes, jumper, next, pager, prev, total",activeTab:"0",stopGoodsList:[],stopListLoading:!0,stopListQuery:{page:1,limit:10,type:0},stopTotal:0,multipleSelectionStop:[]}},methods:{handleCommand:function(t){"del"==t?this.showDelBox():"stop"==t?this.showStopBox():this.showSaleBox()},handleGoodsFilter:function(){this.listQuery.page=1,this.getGoodsList()},handleSearch:function(){this.handleGoodsFilter()},handleSelectionChange:function(t){0==this.activeTab?this.multipleSelection=t:this.multipleSelectionStop=t},showDelBox:function(){var t=this;0!=this.multipleSelectionStop.length?this.$confirm("确定永久性删除此商品吗?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){t.handledelGoods()}).catch(function(t){}):this.$message.warning("请选择商品进行操作")},handledelGoods:function(){var t=[];this.multipleSelectionStop.forEach(function(e,o){t.push(e.product_id)});var e=t.join(",");this.deleteProducts(e)},handleSort:function(t){var e={},o=t.prop,i="ascending"==t.order?"asc":"descending"==t.order?"desc":"";switch(console.log(t),o){case"code":e.code=i;break;case"category":e.category=i;break;case"price":e.price=i;break;case null:e={}}var a=this.listQuery,n=a.limit,l=a.category_id,r=a.search;this.listQuery=s()({},{page:1,limit:n,category_id:l,search:r},e),this.getGoodsList(),console.log(this.listQuery)},resetTemp:function(){this.temp={id:null,item:{name:"",category_id:this.commandFilterList[0].id,price:"",remark:"",code:"",sku:"",imageurl:""}}},handleAdd:function(){var t=this;this.resetTemp(),Object(d.o)().then(function(e){var o=e.success.data;t.temp.item.code=o.code,console.log(t.temp.code),t.editStatus.autoCoding=""!=t.temp.item.code,t.dialogStatus="create",t.dialogEditFormVisible=!0,t.$nextTick(function(){t.$refs.dataForm.clearValidate()})})},createData:function(){var t=this;this.$refs.dataForm.validate(function(e){e&&Object(d.d)(t.temp.item).then(function(e){console.log(t.temp),t.getGoodsList(),t.$message.success("新增成功"),t.editStatus.autoAdd?t.handleAdd():(t.dialogEditFormVisible=!1,console.log(t.temp.item))}).catch(function(t){console.log(t)})})},handleEdit:function(t){var e=this;this.resetTemp(),this.editStatus.autoCoding=!0,this.temp.id=t.id,console.log(this.temp.id),Object(d.r)(this.temp.id).then(function(t){var o=t.success.data;console.log(o);var i=o.code,a=o.sku,n=o.item,l=n.category_id,r=n.imageurl,c=n.name,u=n.price,d=n.remark;e.temp=s()({},e.temp,{item:{category_id:l,name:c,price:u,remark:d,code:i,sku:a,imageurl:r}}),e.dialogStatus="edit",e.dialogEditFormVisible=!0,e.$nextTick(function(){e.$refs.dataForm.clearValidate()})})},updateData:function(){var t=this;this.$refs.dataForm.validate(function(e){e&&Object(d.l)(t.temp.id,t.temp.item).then(function(e){t.dialogEditFormVisible=!1,console.log(t.temp),t.getGoodsList(),t.$message.success("编辑成功")}).catch(function(t){console.log(t)})})},getGoodsList:function(){var t=this;this.listLoading=!0,Object(d.v)(this.listQuery).then(function(e){var o=e.success.data;0==t.commandFilterList.length&&(t.commandFilterList=[].concat(a()(o.cateinfo))),t.goodsList=[].concat(a()(o.item.data)),t.total=o.item.total,t.listLoading=!1,console.log("产品列表",t.goodsList)})},handleDelete:function(t){var e=this,o=t.product_id;this.$confirm("确定永久性删除此商品吗?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){e.deleteProducts(o)}).catch(function(t){})},deleteProducts:function(t){var e=this;Object(d.h)(t).then(function(t){e.getStopGoodsList(),e.$message.success("删除成功")}).catch(function(t){console.log(t),e.$message.error("删除失败")})},getStopGoodsList:function(){var t=this;this.stopListLoading=!0,Object(d.w)(this.stopListQuery).then(function(e){var o=e.success.data;t.stopGoodsList=[].concat(a()(o.data)),t.stopTotal=o.total,t.stopListLoading=!1,console.log("停售产品列表",t.stopGoodsList)}).catch(function(t){})},handleStop:function(t){var e=this,o=t.item_id;this.$confirm("确定停售此商品吗?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){e.stopProducts(o)}).catch(function(t){})},stopProducts:function(t){var e=this;Object(d.z)(t).then(function(t){e.getGoodsList(),e.getStopGoodsList(),e.$message.success("停售成功")}).catch(function(t){console.log(t)})},handleSale:function(t){var e=this,o=t.id;this.$confirm("确定开售此商品吗?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){e.saleProducts(o)}).catch(function(t){})},saleProducts:function(t){var e=this;Object(d.x)(t).then(function(t){e.getGoodsList(),e.getStopGoodsList(),console.log("开售成功")}).catch(function(t){console.log(t)})},showStopBox:function(){var t=this;0!=this.multipleSelection.length?this.$confirm("确定停售此商品吗?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){var e=t.multipleSelection.map(function(t,e){return t.item_id});e.join(","),t.stopProducts(e)}).catch(function(t){}):this.$message.warning("请选择商品进行操作")},showSaleBox:function(){var t=this;0!=this.multipleSelectionStop.length?this.$confirm("确定开售此商品吗?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){var e=t.multipleSelectionStop.map(function(t,e){return t.id});e.join(","),t.saleProducts(e)}).catch(function(t){}):this.$message.warning("请选择商品进行操作")}},computed:{syncDialogShow:function(){return this.synchrodataDialog.show}},watch:{syncDialogShow:function(t,e){t||this.getGoodsList()},activeTab:function(t,e){0!=t||this.goodsList.length?1!=t||this.stopGoodsList.length||this.getStopGoodsList():this.getGoodsList()}},mounted:function(){},created:function(){this.getGoodsList()}},p=(o("+Ao4"),o("ZWgD"),o("ZrdR")),g=Object(p.a)(m,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container product_goods"},[o("el-card",{staticClass:"filter-box mb-15",attrs:{shadow:"always"}},[o("action-bar",{attrs:{activeName:t.synchrodataDialog.activeName,category_id:t.listQuery.category_id,commandFilterList:t.commandFilterList,search:t.listQuery.search,activeTab:t.activeTab},on:{"update:category_id":function(e){t.$set(t.listQuery,"category_id",e)},"update:search":function(e){t.$set(t.listQuery,"search",e)},"update:activeTab":function(e){t.activeTab=e},handleCommand:t.handleCommand,handleGoodsFilter:t.handleGoodsFilter,handleSearch:t.handleSearch,showSynchroDialog:function(e){t.synchrodataDialog.show=!0},handleAdd:t.handleAdd}},[o("template",{slot:"0"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"goodsList",staticClass:"goods_list",staticStyle:{width:"100%"},attrs:{data:t.goodsList,fit:"",stripe:""},on:{"selection-change":t.handleSelectionChange,"sort-change":t.handleSort}},[o("el-table-column",{attrs:{align:"left",type:"index",width:"40px"}}),t._v(" "),o("el-table-column",{attrs:{align:"left",type:"selection",width:"30px"}}),t._v(" "),o("el-table-column",{attrs:{align:"left",label:"编码",prop:"code",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(e.row.code))])]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"left",label:"名称",prop:"name",width:"420px"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",{staticClass:"product_name"},[o("span",{staticClass:"product_img"},[o("img",{directives:[{name:"productImg",rawName:"v-productImg",value:e.row.item.imageurl,expression:"scope.row.item.imageurl"}]})]),t._v("\n                "+t._s(e.row.item.name)+"\n              ")])]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"left",label:"来源"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(e.row.item.source_item_id>0?"总部分配":"单店添加"))])]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"left",label:"分类",prop:"category",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(e.row.item.category?e.row.item.category.name:"-"))])]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"left",label:"单价",prop:"price",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(t._f("formatMoney")(e.row.item.price)))])]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"left",label:"规格",prop:"sku"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(null==e.row.sku||""==e.row.sku?"-":e.row.sku))])]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"left",label:"备注"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(null==e.row.item.remark||""==e.row.item.remark?"-":e.row.item.remark))])]}}])}),t._v(" "),o("el-table-column",{attrs:{width:"160",align:"left",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){t.handleEdit(e.row)}}},[t._v("编辑")]),t._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(o){t.handleStop(e.row)}}},[t._v("停售")])]}}])})],1),t._v(" "),o("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],staticClass:"pagination",attrs:{layout:t.layout,total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){t.$set(t.listQuery,"page",e)},"update:limit":function(e){t.$set(t.listQuery,"limit",e)},pagination:t.getStopGoodsList}})],1),t._v(" "),o("template",{slot:"1"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.stopListLoading,expression:"stopListLoading"}],ref:"goodsList",staticClass:"goods_list",staticStyle:{width:"100%"},attrs:{data:t.stopGoodsList,fit:"",stripe:""},on:{"selection-change":t.handleSelectionChange,"sort-change":t.handleSort}},[o("el-table-column",{attrs:{align:"left",type:"index",width:"40px"}}),t._v(" "),o("el-table-column",{attrs:{align:"left",type:"selection",width:"30px"}}),t._v(" "),o("el-table-column",{attrs:{align:"left",label:"编码",prop:"code",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(e.row.code))])]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"left",label:"名称",prop:"name",width:"420px"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",{staticClass:"product_name"},[o("span",{staticClass:"product_img"},[o("img",{directives:[{name:"productImg",rawName:"v-productImg",value:e.row.imageurl,expression:"scope.row.imageurl"}]})]),t._v("\n                "+t._s(e.row.name)+"\n              ")])]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"left",label:"来源"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(e.row.source_item_id>0?"总部分配":"单店添加"))])]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"left",label:"分类",prop:"category",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(e.row.category?e.row.category.name:"-"))])]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"left",label:"单价",prop:"price",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(t._f("formatMoney")(e.row.price)))])]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"left",label:"规格",prop:"sku"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(null==e.row.sku||""==e.row.sku?"-":e.row.sku))])]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"left",label:"备注"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(null==e.row.remark||""==e.row.remark?"-":e.row.remark))])]}}])}),t._v(" "),o("el-table-column",{attrs:{width:"160",align:"left",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){t.handleSale(e.row)}}},[t._v("开售")]),t._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(o){t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),o("pagination",{directives:[{name:"show",rawName:"v-show",value:t.stopTotal>0,expression:"stopTotal>0"}],staticClass:"pagination",attrs:{layout:t.layout,total:t.stopTotal,page:t.stopListQuery.page,limit:t.stopListQuery.limit},on:{"update:page":function(e){t.$set(t.stopListQuery,"page",e)},"update:limit":function(e){t.$set(t.stopListQuery,"limit",e)},pagination:t.getStopGoodsList}})],1)],2),t._v(" "),o("el-dialog",{staticClass:"goods_dialog",attrs:{title:t.dialogTitle[t.dialogStatus],visible:t.dialogEditFormVisible,width:"770px"},on:{"update:visible":function(e){t.dialogEditFormVisible=e},closed:function(e){t.editStatus.autoAdd=!1}}},[o("el-form",{ref:"dataForm",attrs:{"label-position":"right","label-width":"80px",model:t.temp,rules:t.rules,"show-message":!0}},[o("el-row",{attrs:{gutter:20}},[o("el-col",{staticClass:"left_content",attrs:{span:13}},[o("upload-image",{attrs:{imageurl:t.temp.item.imageurl},on:{"update:imageurl":function(e){t.$set(t.temp.item,"imageurl",e)}}})],1),t._v(" "),o("el-col",{attrs:{span:11}},[o("el-form-item",{attrs:{label:"编码",prop:"item.code"}},[o("el-input",{model:{value:t.temp.item.code,callback:function(e){t.$set(t.temp.item,"code",e)},expression:"temp.item.code"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"名称",prop:"item.name"}},[o("el-input",{model:{value:t.temp.item.name,callback:function(e){t.$set(t.temp.item,"name",e)},expression:"temp.item.name"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"商品分类",prop:"item.category_id"}},[o("el-select",{staticStyle:{width:"100%"},model:{value:t.temp.item.category_id,callback:function(e){t.$set(t.temp.item,"category_id",e)},expression:"temp.item.category_id"}},t._l(t.commandFilterList,function(t,e,i){return o("el-option",{key:i,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),o("el-form-item",{attrs:{label:"单价",prop:"item.price"}},[o("el-input",{model:{value:t.temp.item.price,callback:function(e){t.$set(t.temp.item,"price",e)},expression:"temp.item.price"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"商品规格"}},[o("el-input",{model:{value:t.temp.item.sku,callback:function(e){t.$set(t.temp.item,"sku",e)},expression:"temp.item.sku"}})],1),t._v(" "),o("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:3},model:{value:t.temp.item.remark,callback:function(e){t.$set(t.temp.item,"remark",e)},expression:"temp.item.remark"}})],1)],1)],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",staticStyle:{"vertical-align":"middle"},attrs:{slot:"footer"},slot:"footer"},["create"==t.dialogStatus?o("div",{staticClass:"fl",staticStyle:{"vertical-align":"middle","margin-top":"10px"}},[o("el-checkbox",{model:{value:t.editStatus.autoAdd,callback:function(e){t.$set(t.editStatus,"autoAdd",e)},expression:"editStatus.autoAdd"}},[t._v("连续增加")])],1):t._e(),t._v(" "),o("el-button",{on:{click:function(e){t.dialogEditFormVisible=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){"create"==t.dialogStatus?t.createData():t.updateData()}}},[t._v("确 定")])],1)],1),t._v(" "),o("synchrodata-dialog",{attrs:{visible:t.synchrodataDialog.show,activeName:t.synchrodataDialog.activeName},on:{"update:visible":function(e){t.$set(t.synchrodataDialog,"show",e)}}})],1)],1)},[],!1,null,"10171a2d",null);g.options.__file="goods.vue";e.default=g.exports}}]);